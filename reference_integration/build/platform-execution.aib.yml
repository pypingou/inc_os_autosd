# *******************************************************************************
# Copyright (c) 2025 Contributors to the Eclipse Foundation
#
# See the NOTICE file(s) distributed with this work for additional
# information regarding copyright ownership.
#
# This program and the accompanying materials are made available under the
# terms of the Apache License Version 2.0 which is available at
# https://www.apache.org/licenses/LICENSE-2.0
#
# SPDX-License-Identifier: Apache-2.0
# *******************************************************************************

name: esdv-score-bazel

content:
  repos:
    - id: epel
      baseurl: https://dl.fedoraproject.org/pub/epel/$distro_version/Everything/$arch/
    - id: bazel-copr
      baseurl: https://download.copr.fedorainfracloud.org/results/lihaohong/bazel/epel-$distro_version-$arch/
  rpms:
    - git
    - openssh-server
    - java-21-openjdk
    - zip
    - python3
    - bazel7
  make_dirs:
    - path: /opt/score/src
      mode: 0755
      parents: true
      exist_ok: true
  add_files:
    - path: /etc/tmpfiles.d/bazel.conf
      text: |
        L /usr/local/bin/bazel - - - - /usr/bin/bazel7

image:
  hostname: esdv-score-bazel
  selinux_booleans:
    domain_can_mmap_files: true
  image_size: 10 GiB
  partitions:
    boot:
      size: 300 MiB
    var:
      relative_size: 0.3

network:
  static: {}

auth:
  sshd_config:
    PasswordAuthentication: true
    PermitRootLogin: true
  groups:
    guest:
      gid: 2000

